<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Escala Automatizada - Fisioterapia UTI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

  <style>
    /* ============================================================
       üé® CORES (PALETA) ‚Äî edite aqui se quiser mudar o visual
       ============================================================ */
    :root {
      /* üëá AQUI VOCE MUDA A COR DA PLANILHA */
      --azul-bebe: #e3f2fd;
      --azul-marinho: #0d47a1;
      --verde-escuro: #1b5e20;
      --cinza-claro: #f5f5f5;
      --cinza-borda: #d0d0d0;
      --texto-principal: #1f2933;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e3f2fd 0, #ffffff 55%, #bbdefb 100%);
      color: var(--texto-principal);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 12px 8px;
    }

    .app-container {
      width: 100%;
      max-width: 1100px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      padding: 16px 14px 18px;
    }

    @media (min-width: 480px) {
      body { padding: 14px 10px; }
      .app-container { padding: 18px 16px 20px; }
    }

    @media (min-width: 768px) {
      body { padding: 16px; }
      .app-container { padding: 24px 26px 26px; }
    }

    .header {
      display: flex;
      flex-direction: column;
      gap: 3px;
      margin-bottom: 14px;
      border-bottom: 1px solid rgba(13, 71, 161, 0.1);
      padding-bottom: 8px;
    }

    .header-top-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      flex-wrap: wrap;
    }

    .title {
      font-size: 1rem;
      font-weight: 700;
      color: var(--azul-marinho);
      letter-spacing: 0.02em;
      text-transform: uppercase;
      line-height: 1.2;
    }

    @media (min-width: 480px) { .title { font-size: 1.1rem; } }
    @media (min-width: 768px) { .title { font-size: 1.25rem; } }

    .credit {
      font-size: 0.7rem;
      color: rgba(0, 0, 0, 0.45);
      font-weight: 500;
      white-space: nowrap;
    }
    @media (min-width: 480px) { .credit { font-size: 0.73rem; } }

    .subtitle {
      font-size: 0.78rem;
      color: rgba(0, 0, 0, 0.7);
      max-width: 100%;
      line-height: 1.3;
    }
    @media (min-width: 480px) { .subtitle { font-size: 0.8rem; } }
    @media (min-width: 768px) { .subtitle { font-size: 0.83rem; } }

    .subtitle span {
      font-weight: 600;
      color: var(--verde-escuro);
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-bottom: 12px;
      background: var(--azul-bebe);
      border-radius: 10px;
      padding: 8px 8px 10px;
      border: 1px solid rgba(13, 71, 161, 0.2);
    }

    @media (min-width: 480px) {
      .controls { gap: 10px; padding: 10px 10px 12px; }
    }
    @media (min-width: 768px) {
      .controls { gap: 12px; padding: 12px 14px; }
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 3px;
      min-width: 100px;
    }

    .control-label {
      font-size: 0.7rem;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.68);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    @media (min-width: 480px) { .control-label { font-size: 0.73rem; } }
    @media (min-width: 768px) { .control-label { font-size: 0.75rem; } }

    select,
    input[type="number"] {
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid rgba(13, 71, 161, 0.35);
      font-size: 0.8rem;
      outline: none;
      background: #ffffff;
      min-height: 30px;
      font-family: inherit;
    }
    @media (min-width: 768px) {
      select, input[type="number"] { font-size: 0.85rem; min-height: 32px; }
    }

    select:focus,
    input[type="number"]:focus {
      border-color: var(--azul-marinho);
      box-shadow: 0 0 0 1px rgba(13, 71, 161, 0.15);
    }

    .btn-primary {
      appearance: none;
      border: none;
      border-radius: 999px;
      padding: 7px 16px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      cursor: pointer;
      color: #ffffff;
      background: linear-gradient(135deg, var(--azul-marinho), #1565c0);
      box-shadow: 0 3px 10px rgba(13, 71, 161, 0.3);
      display: inline-flex;
      align-items: center;
      gap: 5px;
      margin-left: auto;
      margin-top: 2px;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    @media (min-width: 480px) { .btn-primary { font-size: 0.85rem; padding: 8px 18px; gap: 6px; } }
    @media (min-width: 768px) { .btn-primary { font-size: 0.88rem; padding: 8px 18px; } }

    .btn-primary:hover { filter: brightness(1.05); transform: translateY(-0.5px); }
    .btn-primary:active { filter: brightness(0.98); transform: translateY(0.5px); box-shadow: 0 2px 6px rgba(13, 71, 161, 0.25); }

    .btn-primary span.icon { font-size: 0.95rem; }
    @media (min-width: 768px) { .btn-primary span.icon { font-size: 1rem; } }

    .btn-secondary {
      appearance: none;
      border: 1px solid rgba(13, 71, 161, 0.4);
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      cursor: pointer;
      color: var(--azul-marinho);
      background: #ffffff;
      box-shadow: 0 2px 6px rgba(13, 71, 161, 0.1);
      display: inline-flex;
      align-items: center;
      gap: 5px;
      margin-top: 2px;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    @media (min-width: 480px) { .btn-secondary { font-size: 0.85rem; padding: 8px 16px; gap: 6px; } }
    @media (min-width: 768px) { .btn-secondary { font-size: 0.88rem; } }

    .btn-secondary:hover { background: var(--azul-bebe); border-color: var(--azul-marinho); transform: translateY(-0.5px); }
    .btn-secondary:active { transform: translateY(0.5px); box-shadow: 0 1px 3px rgba(13, 71, 161, 0.12); }

    .btn-secondary span.icon { font-size: 0.95rem; }
    @media (min-width: 768px) { .btn-secondary span.icon { font-size: 1rem; } }

    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(13, 71, 161, 0.15);
      justify-content: flex-start;
    }

    @media (min-width: 480px) { .action-buttons { gap: 8px; margin-top: 12px; padding-top: 12px; } }
    @media (min-width: 768px) { .action-buttons { gap: 8px; margin-top: 12px; padding-top: 12px; } }

    .info-bar {
      font-size: 0.75rem;
      color: rgba(0, 0, 0, 0.6);
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      flex-wrap: wrap;
    }

    @media (min-width: 480px) {
      .info-bar { font-size: 0.77rem; flex-direction: row; gap: 8px; }
    }

    @media (min-width: 768px) {
      .info-bar { font-size: 0.78rem; justify-content: space-between; gap: 10px; }
    }

    .info-highlight {
      font-weight: 600;
      color: var(--verde-escuro);
    }

    .table-wrapper {
      width: 100%;
      overflow-x: auto;
      border-radius: 10px;
      border: 1px solid rgba(0, 0, 0, 0.06);
      background: linear-gradient(to bottom, #ffffff, #fafafa);
      -webkit-overflow-scrolling: touch;
    }
    @media (min-width: 768px) { .table-wrapper { border-radius: 14px; } }

    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 480px;
      table-layout: fixed;
      font-size: 0.75rem;
    }

    @media (min-width: 480px) { table { font-size: 0.78rem; min-width: 520px; } }
    @media (min-width: 768px) { table { font-size: 0.82rem; min-width: 540px; } }

    thead {
      background: linear-gradient(90deg, var(--azul-marinho), #1565c0);
      color: #ffffff;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    thead th {
      padding: 6px 4px;
      text-align: left;
      font-weight: 600;
      border-bottom: 1px solid rgba(255, 255, 255, 0.25);
      white-space: nowrap;
      font-size: 0.7rem;
    }

    @media (min-width: 480px) { thead th { padding: 7px 5px; font-size: 0.73rem; } }
    @media (min-width: 768px) { thead th { padding: 8px 6px; font-size: 0.75rem; } }

    thead th:nth-child(1) { width: 80px; }
    @media (min-width: 480px) { thead th:nth-child(1) { width: 90px; } }
    @media (min-width: 768px) { thead th:nth-child(1) { width: 96px; } }

    thead th:nth-child(2) { width: 120px; }
    @media (min-width: 480px) { thead th:nth-child(2) { width: 130px; } }
    @media (min-width: 768px) { thead th:nth-child(2) { width: 140px; } }

    thead th:nth-child(3),
    thead th:nth-child(4) { width: 120px; }
    @media (min-width: 480px) {
      thead th:nth-child(3),
      thead th:nth-child(4) { width: 130px; }
    }
    @media (min-width: 768px) {
      thead th:nth-child(3),
      thead th:nth-child(4) { width: 140px; }
    }

    tbody tr { border-bottom: 1px solid rgba(0, 0, 0, 0.035); }
    tbody tr:nth-child(even) { background: rgba(227, 242, 253, 0.4); }
    tbody tr.weekend-row { background: rgba(200, 230, 201, 0.25); }

    td {
      padding: 5px 4px;
      vertical-align: middle;
      color: #374151;
      word-wrap: break-word;
      hyphens: auto;
      font-size: 0.73rem;
    }

    @media (min-width: 480px) { td { padding: 6px 4px; font-size: 0.76rem; } }
    @media (min-width: 768px) { td { padding: 7px 6px; font-size: 0.82rem; } }

    .day-name { text-transform: capitalize; font-weight: 500; }

    .badge {
      display: inline-block;
      padding: 1px 4px;
      border-radius: 999px;
      font-size: 0.6rem;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      border: 1px solid rgba(27, 94, 32, 0.45);
      color: var(--verde-escuro);
      background: rgba(232, 245, 233, 0.8);
      margin-left: 3px;
      vertical-align: middle;
      font-weight: 600;
    }

    @media (min-width: 480px) { .badge { padding: 2px 5px; font-size: 0.62rem; } }
    @media (min-width: 768px) { .badge { padding: 2px 6px; font-size: 0.65rem; margin-left: 4px; } }

    .footer-note {
      margin-top: 8px;
      font-size: 0.7rem;
      color: rgba(0, 0, 0, 0.55);
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex-wrap: wrap;
    }

    @media (min-width: 480px) { .footer-note { margin-top: 9px; font-size: 0.72rem; gap: 5px; } }
    @media (min-width: 768px) {
      .footer-note { margin-top: 10px; font-size: 0.72rem; justify-content: space-between; flex-direction: row; gap: 10px; }
    }

    .footer-note strong { color: var(--azul-marinho); }

    /* ============================================================
       üñ®Ô∏è IMPRESS√ÉO  ‚úÖ (AJUSTADO PARA 1 FOLHA)
       ============================================================ */
    @media print {

      /* üëá AQUI VOC√ä FOR√áA O PAPEL E ORIENTA√á√ÉO */
      @page {
        size: A4 landscape;  /* üëà MUDE PARA 'A4 portrait' se quiser */
        margin: 4mm;         /* üëà menor margem = mais chance de 1 folha */
      }

      * { margin: 0 !important; padding: 0 !important; }

      html, body {
        width: 100%;
        height: auto;
        background: #fff !important;
      }

      body {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }

      /* üëá REMOVE ‚Äúrespiros‚Äù e espa√ßo extra */
      .app-container {
        max-width: 100% !important;
        box-shadow: none !important;
        border-radius: 0 !important;
        padding: 0 !important;        /* üëà CHAVE */
        margin: 0 !important;
      }

      /* üëá some o que n√£o precisa na impress√£o */
      .controls,
      .action-buttons,
      .footer-note {
        display: none !important;
      }

      /* üëá mant√©m header mas compacta MUITO */
      .header {
        margin: 0 0 2mm 0 !important;        /* üëà menor */
        padding: 0 0 2mm 0 !important;       /* üëà menor */
        border-bottom: 1px solid #0d47a1 !important;
      }

      .title { font-size: 10pt !important; }
      .subtitle { font-size: 7pt !important; margin: 0 !important; }
      .credit { display: none !important; }

      /* üëá info-bar fica, mas super compacta */
      .info-bar {
        font-size: 6.5pt !important;
        line-height: 1.05 !important;
        margin: 0 0 2mm 0 !important;
        gap: 1mm !important;
      }

      /* üëá tira borda ‚Äúgrossa‚Äù pra economizar altura */
      .table-wrapper {
        border: 1px solid #000 !important;
        border-radius: 0 !important;
        overflow: visible !important;
      }

      /* =========================================================
         üëá TABELA: COMPACTA√á√ÉO FORTE (CABER EM 1 FOLHA)
         ========================================================= */
      table {
        width: 100% !important;
        min-width: 100% !important;
        table-layout: fixed !important;
        border-collapse: collapse !important;

        font-size: 6.5pt !important;     /* üëà menor fonte */
        line-height: 1.03 !important;    /* üëà mais ‚Äúapertado‚Äù */
      }

      thead {
        background: #0d47a1 !important;
        color: #fff !important;
      }

      thead th {
        padding: 1.2mm 1.2mm !important; /* üëà menor padding */
        border: 1px solid #000 !important;
        font-size: 6.5pt !important;
        font-weight: 700 !important;
        white-space: nowrap !important;
      }

      td {
        padding: 1.1mm 1.2mm !important;  /* üëà ESSENCIAL */
        border: 1px solid #ccc !important;
        font-size: 6.5pt !important;
        vertical-align: top !important;
      }

      .badge {
        font-size: 5.6pt !important;
        padding: 0.4mm 1mm !important;
      }

      /* =========================================================
         üëá ANTI-QUEBRA (n√£o deixa dividir a tabela em 2 p√°ginas)
         ========================================================= */
      tr, td, th, thead, tbody {
        break-inside: avoid !important;
        page-break-inside: avoid !important;
      }

      thead { display: table-header-group; }
      tfoot { display: table-footer-group; }
    }

    /* ============================================================
       üì± MOBILE (‚â§479px)
       ============================================================ */
    @media (max-width: 479px) {
      body { padding: 10px 6px; }

      .app-container {
        padding: 12px 10px 14px;
        border-radius: 12px;
      }

      .header {
        margin-bottom: 10px;
        padding-bottom: 6px;
        gap: 2px;
      }

      .title {
        line-height: 1.15;
        word-break: break-word;
      }

      .controls {
        flex-direction: column;
        align-items: stretch;
        gap: 6px;
        padding: 8px;
      }

      .control-group { width: 100%; }
      select, input[type="number"] { width: 100%; }

      .btn-primary {
        width: 100%;
        justify-content: center;
        margin-left: 0;
      }

      .action-buttons {
        flex-direction: column;
        gap: 6px;
      }

      .btn-secondary {
        width: 100%;
        justify-content: center;
      }

      .info-bar { font-size: 0.73rem; gap: 4px; }

      .table-wrapper {
        margin: 0 -10px;
        border-radius: 0;
        border-left: none;
        border-right: none;
      }

      table { min-width: 100%; }
    }
  </style>
</head>

<body>
  <div class="app-container">

    <header class="header">
      <div class="header-top-row">
        <div class="title">Escala da Fisioterapia - UTI Adulto</div>
        <div class="credit">Desenvolvido por: Gabriela Cangu√ßu</div>
      </div>
      <div class="subtitle">
        <span>Selecione o m√™s e ano para gerar a escala</span>
      </div>
    </header>

    <section class="controls">
      <div class="control-group">
        <label class="control-label" for="mesSelect">M√™s</label>
        <select id="mesSelect">
          <option value="1">Janeiro</option>
          <option value="2">Fevereiro</option>
          <option value="3">Mar√ßo</option>
          <option value="4">Abril</option>
          <option value="5">Maio</option>
          <option value="6">Junho</option>
          <option value="7">Julho</option>
          <option value="8">Agosto</option>
          <option value="9">Setembro</option>
          <option value="10">Outubro</option>
          <option value="11">Novembro</option>
          <option value="12">Dezembro</option>
        </select>
      </div>

      <div class="control-group">
        <label class="control-label" for="anoInput">Ano</label>
        <input type="number" id="anoInput" min="2000" max="2100" />
      </div>

      <button class="btn-primary" id="btnGerar">
        <span class="icon">üìÖ</span>
        <span>Gerar Escala</span>
      </button>

      <div class="action-buttons">
        <button class="btn-secondary" id="btnImprimir">
          <span class="icon">üñ®Ô∏è</span>
          <span>Imprimir</span>
        </button>
      </div>
    </section>

    <div class="info-bar">
      <div>Confira cuidadosamente o dia escalado, o cumprimento dos plant√µes √© de responsabilidade do profissional.</div>

      <div>
        <span class="info-highlight"></span>.
        <!-- üëà escreva aqui algo pra ficar na lateral a direita -->
      </div>

      <div>
        OBS. para os plant√µes dezembro 2025
        <span class="info-highlight">
          RENATA plant√µes de 24 (noite) e 25 (dia) - LUDIMILA estar√° nos plant√µes 31 (noite) e 01 de Janeiro (dia)
        </span>,
      </div>
    </div>
    <!-- üëà FECHA info-bar AQUI -->

    <div class="table-wrapper">
      <table id="tabelaEscala">
        <thead>
          <tr>
            <th>Data</th>
            <th>Dia da semana</th>
            <th>Dia (turno)</th>
            <th>Noite (turno)</th>
          </tr>
        </thead>
        <tbody>
          <!-- Linhas geradas via JavaScript -->
        </tbody>
      </table>
    </div>

    <div class="footer-note">
      <div>
        <strong>Lembrete:</strong> Em caso de 5¬∫ fim de semana, a escala de sexta/s√°bado/domingo repete o 1¬∫ fim de semana do m√™s.
      </div>
      <div>
        Qualquer inconsist√™ncia na escala, favor comunicar √† coordena√ß√£o.
      </div>
    </div>

  </div>

  <script>
    // ============================================================
    // ‚úÖ TEXTOS FIXOS (dias da semana)
    // ============================================================
    const dayNames = ["domingo","segunda-feira","ter√ßa-feira","quarta-feira","quinta-feira","sexta-feira","s√°bado"];

    function pad2(num) { return String(num).padStart(2, "0"); }

    // Retorna n√∫mero de dias do m√™s: 1..31
    function getNumeroDiasMes(ano, mes) {
      return new Date(ano, mes, 0).getDate(); // mes: 1-12
    }

    // ============================================================
    // üë©‚Äç‚öïÔ∏èüë®‚Äç‚öïÔ∏è ESCALA ‚Äî NOMES & REGRAS (EDITE AQUI)
    // ============================================================

    const PLANTONISTAS = {
      // üëá AQUI VOC√ä DEFINE O NOME (se um dia trocar o nome, troca aqui uma vez s√≥ por√©m trocar√° todas os plant√µes para esse nome)
      paulo: "Paulo Valle",
      gabriela: "Gabriela Cangu√ßu",
      renata: "Renata Bittencourt",
      cassio: "Cassio Gomes",
      maxwell: "Maxwell Almeida",
      wesley: "Wesley Barroso",
      armando: "Armando Lelis",
      leticia: "Leticia Modesto",
    };

    // ============================================================
    // ‚úÖ BLOCO 1 ‚Äî SEGUNDA A QUINTA (FIXO)
    // üëá AQUI VOCE PODE MUDAR O PLANTONISTA FIXO DESSE DIA ->
    // ============================================================

    const FIXO_SEGUNDA = { dia: PLANTONISTAS.paulo, noite: PLANTONISTAS.gabriela };
    const FIXO_TERCA   = { dia: PLANTONISTAS.renata, noite: PLANTONISTAS.gabriela };
    const FIXO_QUARTA  = { dia: PLANTONISTAS.gabriela, noite: PLANTONISTAS.renata };
    const FIXO_QUINTA  = { dia: PLANTONISTAS.gabriela, noite: PLANTONISTAS.cassio };

    // ============================================================
    // ‚úÖ BLOCO 2 ‚Äî SEXTA (por ocorr√™ncia no m√™s)
    // ============================================================

    const SEXTA_POR_ORDEM = {
      1: { dia: PLANTONISTAS.maxwell, noite: PLANTONISTAS.wesley },
      2: { dia: PLANTONISTAS.renata,  noite: PLANTONISTAS.wesley },
      3: { dia: PLANTONISTAS.maxwell, noite: PLANTONISTAS.renata },
      4: { dia: PLANTONISTAS.renata,  noite: PLANTONISTAS.wesley },
    };

    // ============================================================
    // ‚úÖ BLOCO 3 ‚Äî S√ÅBADO (por ocorr√™ncia no m√™s)
    // ============================================================

    function escalaSabado(idxFds) {
      const dia = (idxFds === 4) ? PLANTONISTAS.cassio : PLANTONISTAS.wesley;

      let noite = "";
      if (idxFds === 1 || idxFds === 3) noite = PLANTONISTAS.armando;
      else if (idxFds === 2 || idxFds === 4) noite = PLANTONISTAS.paulo;

      return { dia, noite };
    }

    // ============================================================
    // ‚úÖ BLOCO 4 ‚Äî DOMINGO (por ocorr√™ncia no m√™s)
    // ============================================================

    function escalaDomingo(idxFds) {
      let dia = "";
      if (idxFds === 1) dia = PLANTONISTAS.armando;
      else if (idxFds === 2) dia = PLANTONISTAS.paulo;
      else if (idxFds === 3) dia = PLANTONISTAS.cassio;
      else if (idxFds === 4) dia = PLANTONISTAS.paulo;

      let noite = "";
      if (idxFds === 1 || idxFds === 3) noite = PLANTONISTAS.paulo;
      else if (idxFds === 2 || idxFds === 4) noite = PLANTONISTAS.leticia;

      return { dia, noite };
    }

    // ============================================================
    // üîé Fun√ß√£o central: calcula dia/noite para uma data
    // ============================================================
    function getEscalaParaData(date) {
      const diaDoMes = date.getDate();
      const wd = date.getDay();
      const ocorrencia = Math.floor((diaDoMes - 1) / 7) + 1;

      let idxFds = ocorrencia;
      if ((wd === 5 || wd === 6 || wd === 0) && ocorrencia > 4) idxFds = 1;

      let diaTurno = "";
      let noiteTurno = "";

      switch (wd) {
        case 1:
          diaTurno = FIXO_SEGUNDA.dia;
          noiteTurno = FIXO_SEGUNDA.noite;
          break;
        case 2:
          diaTurno = FIXO_TERCA.dia;
          noiteTurno = FIXO_TERCA.noite;
          break;
        case 3:
          diaTurno = FIXO_QUARTA.dia;
          noiteTurno = FIXO_QUARTA.noite;
          break;
        case 4:
          diaTurno = FIXO_QUINTA.dia;
          noiteTurno = FIXO_QUINTA.noite;
          break;
        case 5: {
          const regra = SEXTA_POR_ORDEM[idxFds] || SEXTA_POR_ORDEM[1];
          diaTurno = regra.dia;
          noiteTurno = regra.noite;
          break;
        }
        case 6: {
          const r = escalaSabado(idxFds);
          diaTurno = r.dia;
          noiteTurno = r.noite;
          break;
        }
        case 0: {
          const r = escalaDomingo(idxFds);
          diaTurno = r.dia;
          noiteTurno = r.noite;
          break;
        }
        default:
          diaTurno = "";
          noiteTurno = "";
      }

      return { diaTurno, noiteTurno, ocorrencia, idxFds };
    }

    // ============================================================
    // üßæ Render da tabela
    // ============================================================
    function gerarEscala() {
      const mesSelect = document.getElementById("mesSelect");
      const anoInput  = document.getElementById("anoInput");
      const tbody     = document.querySelector("#tabelaEscala tbody");

      const mes = parseInt(mesSelect.value, 10);
      const ano = parseInt(anoInput.value, 10);

      if (isNaN(ano) || ano < 2000 || ano > 2100) {
        alert("Por favor, preencha um ano entre 2000 e 2100.");
        return;
      }

      const numDias = getNumeroDiasMes(ano, mes);
      tbody.innerHTML = "";

      for (let dia = 1; dia <= numDias; dia++) {
        const data = new Date(ano, mes - 1, dia);
        const wd = data.getDay();
        const dayLabel = dayNames[wd];

        const { diaTurno, noiteTurno, ocorrencia } = getEscalaParaData(data);

        const tr = document.createElement("tr");
        if (wd === 0 || wd === 6) tr.classList.add("weekend-row");

        const tdData = document.createElement("td");
        tdData.textContent = `${pad2(dia)}/${pad2(mes)}/${ano}`;

        const tdDiaSemana = document.createElement("td");
        tdDiaSemana.innerHTML = `
          <span class="day-name">${dayLabel}</span>
          ${
            wd === 5 || wd === 6 || wd === 0
              ? `<span class="badge">${ocorrencia}¬∫ ${wd === 5 ? "sexta" : wd === 6 ? "s√°bado" : "domingo"}</span>`
              : ""
          }
        `;

        const tdDiaTurno = document.createElement("td");
        tdDiaTurno.textContent = diaTurno || "-";

        const tdNoiteTurno = document.createElement("td");
        tdNoiteTurno.textContent = noiteTurno || "-";

        tr.appendChild(tdData);
        tr.appendChild(tdDiaSemana);
        tr.appendChild(tdDiaTurno);
        tr.appendChild(tdNoiteTurno);

        tbody.appendChild(tr);
      }
    }

    function imprimirEscala() { window.print(); }

    (function init() {
      const hoje = new Date();
      const mesAtual = hoje.getMonth() + 1;
      const anoAtual = hoje.getFullYear();

      document.getElementById("mesSelect").value = mesAtual.toString();
      document.getElementById("anoInput").value = anoAtual.toString();

      document.getElementById("btnGerar").addEventListener("click", gerarEscala);
      document.getElementById("btnImprimir").addEventListener("click", imprimirEscala);

      gerarEscala();
    })();
  </script>
</body>
</html>
